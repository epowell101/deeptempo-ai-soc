{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://deeptempo.ai/schemas/case.schema.json",
  "title": "Investigation Case",
  "description": "An investigation case grouping related security findings",
  "type": "object",
  "required": ["case_id", "title", "finding_ids", "status", "created_at"],
  "properties": {
    "case_id": {
      "type": "string",
      "description": "Unique identifier for the case",
      "pattern": "^case-[0-9]{4}-[0-9]{2}-[0-9]{2}-[a-f0-9]{8}$",
      "examples": ["case-2024-01-15-a1b2c3d4"]
    },
    "title": {
      "type": "string",
      "description": "Case title",
      "minLength": 1,
      "maxLength": 200
    },
    "description": {
      "type": "string",
      "description": "Detailed case description"
    },
    "finding_ids": {
      "type": "array",
      "description": "List of finding IDs included in this case",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },
    "status": {
      "type": "string",
      "enum": ["new", "investigating", "resolved", "closed", "false_positive"],
      "description": "Case status"
    },
    "priority": {
      "type": "string",
      "enum": ["low", "medium", "high", "critical"],
      "description": "Case priority"
    },
    "assignee": {
      "type": "string",
      "description": "Assigned analyst"
    },
    "tags": {
      "type": "array",
      "description": "Case tags for categorization",
      "items": {
        "type": "string"
      }
    },
    "notes": {
      "type": "array",
      "description": "Investigation notes",
      "items": {
        "type": "object",
        "required": ["author", "timestamp", "content"],
        "properties": {
          "author": {
            "type": "string",
            "description": "Note author"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Note timestamp"
          },
          "content": {
            "type": "string",
            "description": "Note content"
          }
        }
      }
    },
    "timeline": {
      "type": "array",
      "description": "Case timeline events",
      "items": {
        "type": "object",
        "required": ["timestamp", "event"],
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "event": {
            "type": "string"
          }
        }
      }
    },
    "mitre_techniques": {
      "type": "array",
      "description": "MITRE ATT&CK techniques associated with this case",
      "items": {
        "type": "string",
        "pattern": "^T[0-9]{4}(\\.[0-9]{3})?$"
      }
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Case creation timestamp"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Last update timestamp"
    }
  }
}
